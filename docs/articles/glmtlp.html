<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A introduction to `glmtlp` • glmtlp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A introduction to `glmtlp`">
<meta property="og:description" content="glmtlp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmtlp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/glmtlp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="glmtlp_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A introduction to <code>glmtlp</code>
</h1>
                        <h4 class="author">Chunlin Li</h4>
                        <h4 class="author">Yu Yang</h4>
                        <h4 class="author">Chong Wu</h4>
            
            <h4 class="date">October 12, 2021</h4>
      
      
      <div class="hidden name"><code>glmtlp.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Glmtlp is a package that fits generalized linear and similar models via penalized maximum likelihood. The regularization path is computed for the l0, l1, and TLP penalty at a grid of values (on the log scale) for the regularization parameter lambda or kappa (for l0). The algorithm is extremely fast. It fits linear and logistic regression models. The package includes methods for prediction and plotting, and functions for cross-validation.</p>
<p>The authors of glmtlp are Chunlin Li, Yu Yang, and Chong Wu, and the R package is maintained by Chunlin Li and Yu Yang. A Python version is under development.</p>
<p>This vignette describes basic usage of glmtlp in R.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>There are two versions of our R package. One is on CRAN, which uses R BLAS internally, and the other is on Github, which uses OpenBLAS on Intel chips and uses Accelerate vecLib BLAS on Apple MI chips, and is much faster. We recommend users install the Github version.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"glmtlp"</span><span class="op">)</span></code></pre></div>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<p>In this section, we will go over the main functions and outputs in the package.</p>
<p>First, we load the <code>glmtlp</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yuyangyy.com/glmtlp/">glmtlp</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<p>We load a simulated dataset with continuous response to illustrate the usage of gaussian linear regression.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">gau_data</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">gau_data</span><span class="op">$</span><span class="va">X</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">gau_data</span><span class="op">$</span><span class="va">y</span></code></pre></div>
<p>We fit three models by calling <code>glmtlp</code> with <code>X</code>, <code>y</code>, <code>family="gaussian"</code> and three different <code>penalty</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmtlp.html">glmtlp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, penalty <span class="op">=</span> <span class="st">"tlp"</span><span class="op">)</span>
<span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmtlp.html">glmtlp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, penalty <span class="op">=</span> <span class="st">"l0"</span><span class="op">)</span>
<span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmtlp.html">glmtlp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, penalty <span class="op">=</span> <span class="st">"l1"</span><span class="op">)</span></code></pre></div>
<p><code>fit</code> is an object of class <code>glmtlp</code> that contains all the relevant information of the fitted model for further use. Users can apply <code>plot</code>, <code>coef</code> and <code>predict</code> to the fitted objects to get detailed results.</p>
<p>We can visualize the coefficients by executing the <code>plot</code> method:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, xvar <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></code></pre></div>
<p><img src="glmtlp_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The output is a <code>ggplot</code> object. Therefore, the users are allowed to make further modifications on the plot to suit their own needs. The plot shows the solution path of the model, wich each curve correpsponding to a variable. Users may also choose to annotate the curves by setting <code>label=TRUE</code>. Note that for “l1” or “tlp” penalty, <code>xvar</code> could be chosen from c(“lambda”, “log_lambda”, “deviance”, “l1_norm”), and for “l0” penalty, <code>xvar</code> could be chosen from c(“kappa”, “log_kappa”).</p>
<p>We can use the <code>coef</code> function to obtain the fitted coefficients. By default, the results would be a matrix, with each column representing the coefficients for every <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\kappa\)</span>. The users may also choose to input the desired value of <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\kappa\)</span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>...
##             0.951497   0.866968    0.789949    0.719772    0.655830    0.597568
## intercept -0.4014902 -0.2241503 -0.22950126 -0.19917539 -0.01461969 -0.01461716
## V1         0.0000000  0.0000000  0.00000000  0.85223316  0.99419652  0.99420922
## V2         0.0000000  0.0000000  0.00000000  0.00000000  0.00000000  0.00000000
## V3         0.0000000  0.0000000  0.00000000  0.00000000  0.00000000  0.00000000
## V4         0.0000000  0.0000000  0.00000000  0.00000000  0.00000000  0.00000000
## V5         0.0000000  0.0000000  0.00000000  0.00000000  0.00000000  0.00000000
## V6         0.0000000  0.0000000  0.00000000  0.02910853  0.89831048  0.89831892
## V7         0.0000000  0.0000000  0.00000000  0.00000000  0.00000000  0.00000000
## V8         0.0000000  0.0000000  0.00000000  0.00000000  0.00000000  0.00000000
...</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span>, lambda <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<pre><code>...
##    intercept           V1           V2           V3           V4           V5 
##  0.007502138  0.998217372  0.000000000  0.177551177  0.217621169  0.000000000 
##           V6           V7           V8           V9          V10          V11 
##  0.867575569  0.000000000 -0.033095347  0.160488370  0.830160073  0.000000000 
##          V12          V13          V14          V15          V16          V17 
##  0.000000000  0.000000000  0.000000000  0.931837003  0.000000000  0.000000000 
##          V18          V19          V20 
## -0.002741379  0.000000000  0.849237899
NA
NA
...</code></pre>
<p>In terms of prediction, the users need to input a design matrix and the type, as well as the desired level of regularization parameters.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, lambda <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] -1.5748074  0.3901728  0.1573561 -0.6070150  2.3967091</code></pre>
<p>Cross-validation can be implemented by <code>cv.glmtlp</code> to find the best regularization paramter.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cv.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.glmtlp.html">cv.glmtlp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, penalty <span class="op">=</span> <span class="st">"tlp"</span><span class="op">)</span></code></pre></div>
<p><code>cv.glmtlp</code> returns a <code>cv.glmtlp</code> object, a list with all the ingredients of the cross-validated fit. Users may use <code>coef</code>, <code>predict</code>, and <code>plot</code> to further check the cross-valiation results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">cv.fit</span><span class="op">)</span></code></pre></div>
<pre><code>##  intercept         V1         V2         V3         V4         V5         V6 
## -0.0146163  0.9942102  0.0000000  0.0000000  0.0000000  0.0000000  0.8983251 
##         V7         V8         V9        V10        V11        V12        V13 
##  0.0000000  0.0000000  0.0000000  0.8610009  0.0000000  0.0000000  0.0000000 
##        V14        V15        V16        V17        V18        V19        V20 
##  0.0000000  0.9750232  0.0000000  0.0000000  0.0000000  0.0000000  0.8805657</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cv.fit</span><span class="op">)</span></code></pre></div>
<p><img src="glmtlp_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>This plot is a <code>ggplot</code> object and the users are allowed to make further modifications on it.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Shen, Xiaotong, Wei Pan, and Yunzhang Zhu. “Likelihood-based selection and sharp parameter estimation.” <em>Journal of the American Statistical Association</em> 107.497 (2012): 223-232. <a href="https://doi.org/10.1080/01621459.2011.645783" class="uri">https://doi.org/10.1080/01621459.2011.645783</a>.</p>
<p>Tibshirani, Robert, et al. “Strong rules for discarding predictors in lasso‐type problems.” <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 74.2 (2012): 245-266. <a href="https://doi.org/10.1111/j.1467-9868.2011.01004.x" class="uri">https://doi.org/10.1111/j.1467-9868.2011.01004.x</a>.</p>
<p>Yang, Yi, and Hui Zou. “A coordinate majorization descent algorithm for l1 penalized learning.” <em>Journal of Statistical Computation and Simulation</em> 84.1 (2014): 84-95. <a href="https://doi.org/10.1080/00949655.2012.695374" class="uri">https://doi.org/10.1080/00949655.2012.695374</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Chunlin Li, Yu Yang, Chong Wu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
