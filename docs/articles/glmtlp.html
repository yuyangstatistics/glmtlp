<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An Introduction to glmtlp • glmtlp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to glmtlp">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glmtlp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/glmtlp.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>An Introduction to glmtlp</h1>
                        <h4 data-toc-skip class="author">Chunlin Li, Yu
Yang, Chong Wu</h4>
            
            <h4 data-toc-skip class="date">October 02, 2024</h4>
      

      <div class="d-none name"><code>glmtlp.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>glmtlp</code> fits generalized linear models via penalized
maximum likelihood. It currently supports linear and logistic regression
models. The regularization path is computed for the l0, l1, and TLP
penalty at a grid of values for the regularization parameter lambda
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
(for l1 and TLP penalty) or kappa
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
(for l0 penalty). In addition, the package provides methods for
prediction and plotting, and functions for cross-validation.</p>
<p>The authors of <code>glmtlp</code> are Chunlin Li, Yu Yang, and Chong
Wu, and the R package is maintained by Chunlin Li and Yu Yang. A Python
version is under development.</p>
<p>This vignette describes basic usage of <code>glmtlp</code> in R.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the package from CRAN.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"glmtlp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>In this section, we go over the main functions and outputs in the
package.</p>
<p>First, we load the <code>glmtlp</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yuyangyy.com/glmtlp/">glmtlp</a></span><span class="op">)</span></span></code></pre></div>
<p>We load a simulated data set with continuous response to illustrate
the usage of linear regression.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gau_data</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">gau_data</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">gau_data</span><span class="op">$</span><span class="va">y</span></span></code></pre></div>
<p>We fit three models by calling <code>glmtlp</code> with
<code>X</code>, <code>y</code>, <code>family="gaussian"</code> and three
different <code>penalty</code>. The returned <code>fit</code> is an
object of class <code>glmtlp</code> that contains all relevant
information of the fitted model for further use. Users can apply
<code>plot</code>, <code>coef</code> and <code>predict</code> methods to
the fitted objects to get more detailed results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmtlp.html">glmtlp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, penalty <span class="op">=</span> <span class="st">"tlp"</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmtlp.html">glmtlp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, penalty <span class="op">=</span> <span class="st">"l0"</span><span class="op">)</span></span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmtlp.html">glmtlp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, penalty <span class="op">=</span> <span class="st">"l1"</span><span class="op">)</span></span></code></pre></div>
<p>We can visualize the coefficients and the solution path by executing
the <code>plot</code> method. The output is a <code>ggplot</code>
object. Therefore, the users are allowed to customize the plot to suit
their own needs. The plot shows the solution path of the model, with
each curve corresponding to a variable. Users may also choose to
annotate the curves by setting <code>label=TRUE</code>.
<code>xvar</code> is the index variable to plot against. Note that for
“l1” or “tlp” penalty, <code>xvar</code> could be chosen from
<code>c("lambda", "log_lambda", "deviance", "l1_norm")</code>, and for
“l0” penalty, <code>xvar</code> could be chosen as
<code>"kappa"</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, xvar <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></span></code></pre></div>
<p><img src="glmtlp_files/figure-html/unnamed-chunk-6-1.png" alt="Solution Path Plot: coefficients against parameter lambda." width="700"></p>
<p>We can use the <code>coef</code> function to obtain the fitted
coefficients. By default, the results would be a matrix, with each
column representing the coefficients for every
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>.
The users may also choose to input the desired value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>.
Note that the user-supplied
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
parameter should be in the range of the parameter sequence used in the
fitted model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="va">...</span></span>
<span><span class="co">##              1.32501    1.23571    1.15242     1.07475     1.00232     0.93477</span></span>
<span><span class="co">## intercept -0.2428484 -0.1352757 -0.0235558 -0.02355059 -0.05190855 -0.05192106</span></span>
<span><span class="co">## V1         0.0000000  1.2224980  1.2400538  1.24005913  1.27181076  1.27178077</span></span>
<span><span class="co">## V2         0.0000000  0.0000000  0.0000000  0.00000000  0.00000000  0.00000000</span></span>
<span><span class="co">## V3         0.0000000  0.0000000  0.0000000  0.00000000  0.00000000  0.00000000</span></span>
<span><span class="co">## V4         0.0000000  0.0000000  0.0000000  0.00000000  0.00000000  0.00000000</span></span>
<span><span class="co">## V5         0.0000000  0.0000000  0.0000000  0.00000000  0.00000000  0.00000000</span></span>
<span><span class="co">## V6         0.0000000  0.0000000  0.0000000  0.00000000  0.93236905  0.93231995</span></span>
<span><span class="co">## V7         0.0000000  0.0000000  0.0000000  0.00000000  0.00000000  0.00000000</span></span>
<span><span class="co">## V8         0.0000000  0.0000000  0.0000000  0.00000000  0.00000000  0.00000000</span></span>
<span><span class="va">...</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span>, lambda <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="va">...</span></span>
<span><span class="co">##   intercept          V1          V2          V3          V4          V5 </span></span>
<span><span class="co">##  0.03012329  1.25295108  0.00000000 -0.18639467 -0.15726983 -0.19310409 </span></span>
<span><span class="co">##          V6          V7          V8          V9         V10         V11 </span></span>
<span><span class="co">##  0.91543631  0.00000000  0.01275199  0.00000000  0.70521331  0.19432176 </span></span>
<span><span class="co">##         V12         V13         V14         V15         V16         V17 </span></span>
<span><span class="co">##  0.01640360  0.00000000  0.17320713  1.16204702  0.00000000  0.00000000 </span></span>
<span><span class="co">##         V18         V19         V20 </span></span>
<span><span class="co">##  0.00000000 -0.19471461  0.94229082</span></span>
<span><span class="cn">NA</span></span>
<span><span class="cn">NA</span></span>
<span><span class="va">...</span></span></code></pre>
<p>In addition, we can make predictions by applying the
<code>predict</code> method. For this, users need to input a design
matrix and the type of prediction to be made. Also, users can provide
the desired level of regularization parameters or the indices of the
parameter sequence. If neither is provided, then the prediction will be
made for the whole lambda or kappa sequence.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, lambda <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  0.09972438  2.66195238 -1.33516956  0.33721013 -2.63615326</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, which <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># the 10th lambda in the lambda sequence</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  0.1906092  2.2279251 -1.4255474  0.9313526 -2.8151620</span></span></code></pre>
<p>Cross-validation can be implemented by <code>cv.glmtlp</code> to find
the best regularization parameter. <code>cv.glmtlp</code> returns a
<code>cv.glmtlp</code> object, a list with all the ingredients of the
cross-validated fit. Users may use <code>coef</code>,
<code>predict</code>, and <code>plot</code> to further check the
cross-validation results.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.glmtlp.html">cv.glmtlp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, penalty <span class="op">=</span> <span class="st">"tlp"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>plot</code> method will plot the deviance against the
parameter sequence. The vertical dashed line shows the position of the
index where the smallest CV error is achieved, and users may also choose
to omit it by setting <code>vertical.line = FALSE</code>. Again, the
output is a <code>ggplot</code> object, so users are free to make
modifications to it.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="glmtlp_files/figure-html/unnamed-chunk-10-1.png" alt="Cross-Validation Plot: deviance against log(lambda)." width="700"></p>
<p>The <code>coef</code> and <code>predict</code> method by default use
the parameter that gives the smallest CV error, namely,
<code>which = cv.fit$idx.min</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cv.fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    intercept           V1           V2           V3           V4           V5 </span></span>
<span><span class="co">## -0.009695669  1.240195285  0.000000000  0.000000000  0.000000000  0.000000000 </span></span>
<span><span class="co">##           V6           V7           V8           V9          V10          V11 </span></span>
<span><span class="co">##  0.883162055  0.000000000  0.000000000  0.000000000  0.725706691  0.000000000 </span></span>
<span><span class="co">##          V12          V13          V14          V15          V16          V17 </span></span>
<span><span class="co">##  0.000000000  0.000000000  0.000000000  1.125977511  0.000000000  0.000000000 </span></span>
<span><span class="co">##          V18          V19          V20 </span></span>
<span><span class="co">##  0.000000000  0.000000000  0.981387932</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cv.fit</span>, <span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  0.1906096  2.2279220 -1.4255447  0.9313487 -2.8151577</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Li, C., Shen, X., &amp; Pan, W. (2021). Inference for a large
directed graphical model with interventions. <em>arXiv preprint</em>
arXiv:2110.03805. <a href="https://arxiv.org/abs/2110.03805" class="external-link uri">https://arxiv.org/abs/2110.03805</a>.</p>
<p>Shen, X., Pan, W., &amp; Zhu, Y. (2012). Likelihood-based selection
and sharp parameter estimation. <em>Journal of the American Statistical
Association</em>, 107(497), 223-232. <a href="https://doi.org/10.1080/01621459.2011.645783" class="external-link uri">https://doi.org/10.1080/01621459.2011.645783</a>.</p>
<p>Shen, X., Pan, W., Zhu, Y., &amp; Zhou, H. (2013). On constrained and
regularized high-dimensional regression. <em>Annals of the Institute of
Statistical Mathematics</em>, 65(5), 807-832. <a href="https://doi.org/10.1007/s10463-012-0396-3" class="external-link uri">https://doi.org/10.1007/s10463-012-0396-3</a>.</p>
<p>Tibshirani, R., Bien, J., Friedman, J., Hastie, T., Simon, N.,
Taylor, J., &amp; Tibshirani, R. J. (2012). Strong rules for discarding
predictors in lasso‐type problems. <em>Journal of the Royal Statistical
Society: Series B (Statistical Methodology)</em>, 74(2), 245-266. <a href="https://doi.org/10.1111/j.1467-9868.2011.01004.x" class="external-link uri">https://doi.org/10.1111/j.1467-9868.2011.01004.x</a>.</p>
<p>Yang, Y. &amp; Zou, H. A coordinate majorization descent algorithm
for l1 penalized learning. <em>Journal of Statistical Computation and
Simulation</em> 84.1 (2014): 84-95. <a href="https://doi.org/10.1080/00949655.2012.695374" class="external-link uri">https://doi.org/10.1080/00949655.2012.695374</a>.</p>
<p>Zhu, Y., Shen, X., &amp; Pan, W. (2020). On high-dimensional
constrained maximum likelihood inference. <em>Journal of the American
Statistical Association</em>, 115(529), 217-230. <a href="https://doi.org/10.1080/01621459.2018.1540986" class="external-link uri">https://doi.org/10.1080/01621459.2018.1540986</a>.</p>
<p>Zhu, Y. (2017). An augmented ADMM algorithm with application to the
generalized lasso problem. <em>Journal of Computational and Graphical
Statistics</em>, 26(1), 195-204. <a href="https://doi.org/10.1080/10618600.2015.1114491" class="external-link uri">https://doi.org/10.1080/10618600.2015.1114491</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chunlin Li, Yu Yang, Chong Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
