<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>fit a GLM with l0, l1, or tlp regularization — glmtlp • glmtlp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="fit a GLM with l0, l1, or tlp regularization — glmtlp" />
<meta property="og:description" content="Fit a generalize linear model via penalized maximum likelihood. The 
  regularization path is computed for the l0, lasso, or truncated lasso 
  penalty at a grid of values for the regularization parameter num of 
  nonzeros or lambda. Can deal with all shapes of data (not large sparse 
  data matrices now). Fits linear, logistic, multinomial, and poisson models.  
The sequence of models implied by lambda or kappa is fit by 
  coordinate descent.
The package provides 3 penalties: l0, l1, and tlp and 3 distribution families: 
  gaussian, binomial, and poisson." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmtlp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>fit a GLM with l0, l1, or tlp regularization</h1>
    
    <div class="hidden name"><code>glmtlp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit a generalize linear model via penalized maximum likelihood. The 
  regularization path is computed for the l0, lasso, or truncated lasso 
  penalty at a grid of values for the regularization parameter num of 
  nonzeros or lambda. Can deal with all shapes of data (not large sparse 
  data matrices now). Fits linear, logistic, multinomial, and poisson models.</p>  
<p>The sequence of models implied by <code>lambda</code> or <code>kappa</code> is fit by 
  coordinate descent.</p>
<p>The package provides 3 penalties: l0, l1, and tlp and 3 distribution families: 
  gaussian, binomial, and poisson.</p>
    </div>

    <pre class="usage"><span class='fu'>glmtlp</span><span class='op'>(</span>
  <span class='va'>X</span>,
  <span class='va'>y</span>,
  family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gaussian"</span>, <span class='st'>"binomial"</span><span class='op'>)</span>,
  penalty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"l0"</span>, <span class='st'>"l1"</span>, <span class='st'>"tlp"</span><span class='op'>)</span>,
  nlambda <span class='op'>=</span> <span class='fl'>100</span>,
  lambda.min.ratio <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>nobs</span> <span class='op'>&lt;</span> <span class='va'>nvars</span>, <span class='fl'>0.01</span>, <span class='fl'>1e-04</span><span class='op'>)</span>,
  lambda <span class='op'>=</span> <span class='cn'>NULL</span>,
  kappa <span class='op'>=</span> <span class='cn'>NULL</span>,
  tau <span class='op'>=</span> <span class='fl'>0.3</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>nvars</span><span class='op'>)</span><span class='op'>/</span><span class='va'>nobs</span><span class='op'>)</span>,
  delta <span class='op'>=</span> <span class='fl'>2</span>,
  tol <span class='op'>=</span> <span class='fl'>1e-04</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  penalty.factor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>nvars</span><span class='op'>)</span>,
  standardize <span class='op'>=</span> <span class='cn'>TRUE</span>,
  dc.maxit <span class='op'>=</span> <span class='fl'>20</span>,
  cd.maxit <span class='op'>=</span> <span class='fl'>10000</span>,
  nr.maxit <span class='op'>=</span> <span class='fl'>500</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>input matrix, of dimension <code>nobs</code> x <code>nvars</code>; 
each row is  an observation vector. Currently, doesn't support the sparse 
matrix format (inherit from class <code>"sparseMatrix"</code> as in package 
<code>Matrix</code>).</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>response variable, of length nobs. Quantitative for 
<code>family="gaussian"</code>, or <code>family="poisson"</code> (non-negative counts). 
For <code>family="binomial"</code>, should be either a factor with two levels. 
For <code>family="multinomial"</code>, (to be added).</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>a character string representing one of the built-in families. 
See Details section below.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p>a character string representing one of the built-in penalties. 
"l0" represents <code>L_0</code> penalty, "l1" represents lasso-type penalty, and 
"tlp" represents truncated lasso penalty.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>The number of <code>lambda</code> values. Default is 100.</p></td>
    </tr>
    <tr>
      <th>lambda.min.ratio</th>
      <td><p>Smallest value for <code>lambda</code>, as a fraction of 
<code>lambda.max</code>, the (data derived) entry value (i.e. the smallest value 
for which all coefficients are zero). The default depends on the sample size 
<code>nobs</code> relative to the number of variables <code>nvars</code>. If <code>nobs 
&gt; nvars</code>, the default is <code>0.0001</code>, close to zero.  If <code>nobs &lt; 
nvars</code>, the default is <code>0.01</code>.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A user supplied <code>lambda</code> sequence. Typical usage is to
have the program compute its own <code>lambda</code> sequence based on 
<code>nlambda</code> and <code>lambda.min.ratio</code>. Supplying a value of 
<code>lambda</code> overrides this. WARNING: use with care. Avoid supplying a 
single value for <code>lambda</code> (for predictions after CV use 
<code><a href='https://rdrr.io/r/stats/predict.html'>predict()</a></code> instead).  Supply instead a decreasing sequence of 
<code>lambda</code> values. <code>glmtlp</code> relies on its warms starts for speed, 
and its often faster to fit a whole path than compute a single fit. When
the <code>penalty</code> is 'l0', it is not recommended for the users to supply 
this parameter.</p></td>
    </tr>
    <tr>
      <th>kappa</th>
      <td><p>A user supplied <code>kappa</code> sequence. Typical usage is to
have the program compute its own <code>kappa</code> sequence based on <code>nvars</code> 
and <code>nobs</code>. This sequence is used when penalty is 'l0'.</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p>A tuning parameter used in the TLP penalty. Default is 
<code>0.3 * sqrt(log(nvars)/nobs)</code>.</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p>A tuning parameter used in the coordinate majorization descent 
algorithm. See Yang, Y., &amp; Zou, H. (2014) in the reference for detail.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Tolerance level for all the iterative optimization algorithms.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>observation weights. Default is 1 for each observation</p></td>
    </tr>
    <tr>
      <th>penalty.factor</th>
      <td><p>Separate penalty factors can be applied to each 
coefficient. This is a number that multiplies <code>lambda</code> to allow 
differential shrinkage. Can be 0 for some variables, which implies no 
shrinkage, and that variable is always included in the model. Default is 1 
for all variables.</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>Logical. Whether or not standardize the input matrix 
<code>X</code>; default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>dc.maxit</th>
      <td><p>Maximum number of iterations for the DC (Difference of 
Convex Functions) programming; default is 20.</p></td>
    </tr>
    <tr>
      <th>cd.maxit</th>
      <td><p>Maximum number of iterations for the coordinate descent 
algorithm; default is 10^4.</p></td>
    </tr>
    <tr>
      <th>nr.maxit</th>
      <td><p>Maximum number of iterations for the Newton-Rapson method; 
default is 500.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional argument. These include some of the original arguments 
to 'glmtlp', and each must be named if used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object with S3 class <code>"glmtlp"</code>.</p>
<dt>beta</dt><dd><p>a <code>nvars x length(kappa)</code> matrix of
  coefficients when penalty is 'l0'; a <code>nvars x length(lambda)</code> matrix of
  coefficients when penalty is 'l1' and 'tlp'.</p></dd>
<dt>call</dt><dd><p>the call that produced this object.</p></dd> 
<dt>family</dt><dd><p>the distribution family used in the model fitting.</p></dd>
<dt>intercept</dt><dd><p>the intercept vector, of length(kappa) or length(lambda).</p></dd>
<dt>lambda</dt><dd><p>The actual sequence of <code>lambda</code> values used. Note that 
  the length may be smaller than the provided <code>nlambda</code> due to removal 
  of saturated values.</p></dd> 
<dt>penalty</dt><dd><p>the penalty type in the model fitting.</p></dd>
<dt>penalty.factor</dt><dd><p>the penalty factor for each coefficient used in the model fitting.</p></dd>
<dt>tau</dt><dd><p>the tuning parameter used in the model fitting, available when 
  penalty = 'tlp'.</p></dd>
<dt>user.lambda</dt><dd><p>logical, whether or not the used <code>lambda</code> sequence is 
  provided by the user.</p></dd>
<dt>user.kappa</dt><dd><p>logical, whether or not the used <code>kappa</code> sequence is 
  provided by the user, available when penalty = 'l0'.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The objective function for <code>"gaussian"</code> is $$1/2 RSS/nobs +
  \lambda*penalty,$$ and for the other models it is $$-loglik/nobs + 
  \lambda*penalty.$$ 
  Note also that for <code>"gaussian"</code>, <code>glmtlp</code> standardizes y to 
  have unit variance (using 1/(n-1) formula). The coefficients for any 
  predictor variables with zero variance are set to zero for all values of 
  lambda.</p>
<p>## Details on `family` option</p>
<p>glmtlp currently only supports built-in families.</p>
<p>The built in families are specified via a character string. For all families,
the object produced is a regularization path for fitting the generalized 
linear regression paths, by maximizing the appropriate penalized
log-likelihood. Sometimes the sequence is truncated before <code>nlambda</code> 
values of <code>lambda</code> have been used, because of instabilities in the 
inverse link functions near a saturated fit. <code>glmtlp(..., family="binomial")</code> 
fits a traditional logistic regression model for the log-odds.
<code>glmtlp(..., family="multinomial")</code> fits a symmetric multinomial model,
where each class is represented by a linear model (on the log-scale). The
penalties take care of redundancies. A two-class <code>"multinomial"</code> model
will produce the same fit as the corresponding <code>"binomial"</code> model,
except the pair of coefficient matrices will be equal in magnitude and
opposite in sign, and half the <code>"binomial"</code> values.</p>
<p>## Details on `penalty` option</p>
<p>The built in penalties are specified by a character string. For <code>l0</code> 
  penalty, <code>kappa</code> sequence is used for generating the regularization 
  path, while for the other penalties, <code>lambda</code> sequence is used for 
  generating the regularization path.</p>
    <h2 class="hasAnchor" id="glmtlp-functions"><a class="anchor" href="#glmtlp-functions"></a>glmtlp functions</h2>

    

<p>`glmtlp()`, `cv.glmtlp()`</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Shen, X., Pan, W., &amp; Zhu, Y. (2012). 
  <em>Likelihood-based selection and sharp parameter estimation. 
  Journal of the American Statistical Association, 107(497), 223-232.</em>
  <br /> Yang, Y., &amp; Zou, H. (2014). <em>A coordinate majorization descent algorithm 
  for l1 penalized learning. Journal of Statistical Computation and 
  Simulation, 84(1), 84-95.</em>
  <br /> Two R packge Github: <em>ncvreg</em> and <em>glmnet</em>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>print</code>, <code>predict</code>, <code>coef</code> and <code>plot</code> methods,
and the <code>cv.glmtlp</code> function.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Chunlin Li, Yu Yang 
  <br /> Maintainer: Yu Yang <a href='mailto:yang6367@umn.edu'>yang6367@umn.edu</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Gaussian</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='fl'>20</span><span class='op'>)</span>, <span class='fl'>100</span>, <span class='fl'>20</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>fit1</span> <span class='op'>&lt;-</span> <span class='fu'>glmtlp</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span>, family <span class='op'>=</span> <span class='st'>"gaussian"</span>, penalty <span class='op'>=</span> <span class='st'>"l0"</span><span class='op'>)</span>
<span class='va'>fit2</span> <span class='op'>&lt;-</span> <span class='fu'>glmtlp</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span>, family <span class='op'>=</span> <span class='st'>"gaussian"</span>, penalty <span class='op'>=</span> <span class='st'>"l1"</span><span class='op'>)</span>
<span class='va'>fit3</span> <span class='op'>&lt;-</span> <span class='fu'>glmtlp</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span>, family <span class='op'>=</span> <span class='st'>"gaussian"</span>, penalty <span class='op'>=</span> <span class='st'>"tlp"</span><span class='op'>)</span>

<span class='co'># Binomial</span>

<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='fl'>20</span><span class='op'>)</span>, <span class='fl'>100</span>, <span class='fl'>20</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>, <span class='fl'>100</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>glmtlp</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span>, penalty <span class='op'>=</span> <span class='st'>"l1"</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Chunlin Li, Yu Yang, Chong Wu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


